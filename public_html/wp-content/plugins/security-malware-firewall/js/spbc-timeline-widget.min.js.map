{"version":3,"file":"spbc-timeline-widget.min.js","sources":["spbc-timeline-widget.js"],"sourcesContent":["/**\n * Class to render a timeline widget for Security log\n */\nclass SpbcTimelineWidget {\n    // Static constants\n    static markerRadius = 4;\n    static hoursRangeMax = 24;\n    static axisStepsCount = 6;\n    static userActionsUpstep = 12;\n    static legendCircleX = -120;\n    static legendTextX = -105;\n\n    /**\n     * Constructor.\n     */\n    constructor() {\n        // Current time properties\n        this.now = new Date();\n        this.currentTimestamp = Math.floor(this.now.getTime() / 1000);\n\n        // Data properties\n        this.eventsData = null;\n        this.timelineMarkersData = [];\n        this.timelineKnownEventsData = [];\n        this.timelineEventTooltip = null;\n        this.timelineStartTimestamp = this.currentTimestamp - SpbcTimelineWidget.hoursRangeMax * 3600;\n        this.usersCount = 0;\n        this.summaryEventsCount = 0;\n    }\n\n    /**\n     * Initialize and render the timeline widget\n     */\n    render() {\n        if (typeof spbcTimelineWidgetData === 'undefined') {\n            return;\n        }\n\n        this.timelineEventTooltip = document.getElementById('spbc-timeline-tooltip');\n        this.eventsData = spbcTimelineWidgetData.users_actions;\n        this.timelineStartTimestamp = Number(spbcTimelineWidgetData.first_event_timestamp);\n        this.timelineKnownEventsData = spbcTimelineWidgetData.known_events_data;\n        this.timelineMarkersData = this.generateMarkersData(spbcTimelineWidgetData.found_types);\n\n        const activeTab = document.querySelector('.spbc_tab_section--active');\n        if (activeTab && activeTab.id === 'spbc_tab-security_log') {\n            this.initTimeline();\n        }\n\n        // Initialize timeline when tab is loaded\n        window.addEventListener('spbctTabLoaded', (event) => {\n            if (event.detail.tab === 'security_log') {\n                this.initTimeline();\n            }\n        });\n\n        jQuery('#spbc-timeline-tab').on('click', (e)=> {\n            if (e.hasOwnProperty('originalEvent')) {\n                if (localStorage.getItem('spbc_timeline_closed') !== '1') {\n                    localStorage.setItem('spbc_timeline_closed', '1');\n                } else {\n                    localStorage.setItem('spbc_timeline_closed', '0');\n                }\n            }\n        });\n\n        // Handle window resize\n        window.addEventListener('resize', () => {\n            const userSelect = document.getElementById('spbc-timeline-user-select');\n            if (userSelect.value) {\n                this.drawUserTimeline(userSelect.value);\n            }\n        });\n    }\n\n    /**\n     * Initialize timeline with user selection\n     */\n    initTimeline() {\n        const userSelect = document.getElementById('spbc-timeline-user-select');\n        const users = Object.keys(this.eventsData);\n        for (let key in this.eventsData) {\n            if (this.eventsData.hasOwnProperty(key)) {\n                this.usersCount++;\n                this.summaryEventsCount += this.eventsData[key].length;\n            }\n        }\n\n        // Reset user selection dropdown\n        userSelect.innerHTML = '';\n\n        // Populate user options\n        users.forEach((user) => {\n            userSelect.appendChild(new Option(user, user));\n        });\n\n        // Add selection handler\n        userSelect.addEventListener('change', () => {\n            this.drawUserTimeline(userSelect.value);\n        });\n\n        // Draw initial timeline or show message\n        if (users.length > 0) {\n            this.drawUserTimeline(users[0]);\n        } else {\n            document.querySelector('.spbc-timeline-container').style.display = 'none';\n            document.querySelector('.spbc-timeline-controls').style.display = 'none';\n            document.getElementById('spbc-timeline-no-data').style.display = 'block';\n        }\n\n        const activitySelector = jQuery('#spbc_timeline_activity_counters')[0];\n        activitySelector.innerText = activitySelector.innerText\n            .replace('%users_count%', this.usersCount.toString())\n            .replace('%events_count%', this.summaryEventsCount.toString());\n\n        const isWidgetClosedByUser = (\n            localStorage.getItem('spbc_timeline_closed') === '1'\n        );\n        if (!isWidgetClosedByUser) {\n            setTimeout(function() {\n                jQuery('#spbc-timeline-tab').trigger('click');\n            }, 200);\n        }\n    }\n\n    /**\n     * Draw time axis on the timeline\n     * @param {SVGElement} container - SVG container element\n     * @param {number} width - Drawing area width\n     * @param {number} height - Drawing area height\n     */\n    drawTimeAxis(container, width, height) {\n        const timeRange = this.currentTimestamp - this.timelineStartTimestamp;\n        const axis = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n        height = height + 10;\n        // Create main axis line\n        axis.setAttribute('class', 'spbc-timeline-axis');\n        axis.setAttribute('x1', '0');\n        axis.setAttribute('y1', height);\n        axis.setAttribute('x2', width);\n        axis.setAttribute('y2', height);\n        container.appendChild(axis);\n\n        // Create axis ticks and labels\n        for (let i = 0; i <= SpbcTimelineWidget.axisStepsCount; i++) {\n            const timestamp = this.timelineStartTimestamp + (i / SpbcTimelineWidget.axisStepsCount) * timeRange;\n            const x = (i / SpbcTimelineWidget.axisStepsCount) * width;\n\n            // Create tick mark\n            const tick = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n            tick.setAttribute('class', 'spbc-timeline-axis');\n            tick.setAttribute('x1', x);\n            tick.setAttribute('y1', height);\n            tick.setAttribute('x2', x);\n            tick.setAttribute('y2', height + 5);\n            container.appendChild(tick);\n\n            // Create time label\n            const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n            label.setAttribute('class', 'spbc-timeline-axis-text');\n            label.setAttribute('x', x);\n            label.setAttribute('y', height + 20);\n\n            const date = new Date(timestamp * 1000);\n            label.textContent = `${date\n                .getHours()\n                .toString()\n                .padStart(2, '0')}:${date.getMinutes()\n                .toString()\n                .padStart(2, '0')}`;\n            container.appendChild(label);\n        }\n    }\n\n    /**\n     * Create SVG element for an event\n     * @param {Object} event - Event data\n     * @param {number} x - X coordinate\n     * @param {number} y - Y coordinate\n     * @param {string} user - User name\n     * @return {SVGElement} Event group element\n     */\n    createEventElement(event, x, y, user) {\n        const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n        group.setAttribute('transform', `translate(${x}, ${y})`);\n        group.setAttribute('data-event', JSON.stringify({...event, user}));\n\n        // Create event marker\n        const marker = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n        marker.setAttribute('class', 'spbc-timeline-event-marker');\n        marker.setAttribute('r', SpbcTimelineWidget.markerRadius);\n        marker.style.fill = this.timelineMarkersData[event.event].color;\n        group.appendChild(marker);\n\n        // Add event handlers\n        group.addEventListener('mouseenter', this.showEventTooltip.bind(this));\n        group.addEventListener('mouseleave', this.hideEventTooltip.bind(this));\n\n        return group;\n    }\n\n    /**\n     * Show event tooltip\n     * @param {Event} event - Mouse event\n     */\n    showEventTooltip(event) {\n        const eventData = JSON.parse(event.currentTarget.getAttribute('data-event'));\n        const {user, event: eventName, time} = eventData;\n\n        // Format date for display\n        const formatDate = (timestamp) => {\n            const date = new Date(timestamp * 1000);\n\n            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\n                'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n\n            const month = months[date.getMonth()];\n            const day = date.getDate();\n            const dayWithZero = String(day).padStart(2, '0');\n            const year = date.getFullYear();\n\n            const hours = date.getHours().toString().padStart(2, '0');\n            const minutes = date.getMinutes().toString().padStart(2, '0');\n            const seconds = date.getSeconds().toString().padStart(2, '0');\n\n            return `${month} ${dayWithZero} ${year} ${hours}:${minutes}:${seconds}`;\n        };\n\n        // Update tooltip content\n        document.getElementById('spbc-timeline-tooltip--user').innerText = user;\n        document.getElementById('spbc-timeline-tooltip--event').innerText = eventName;\n        document.getElementById('spbc-timeline-tooltip--time').innerText = formatDate(time);\n\n        // define tooltip position\n        const tooltip= document.getElementById('spbc-timeline-tooltip');\n        const fixedTop = event.offsetY + 35;\n        const tooltipY = fixedTop.toString() + 'px';\n        const screenWidth = window.innerWidth;\n        const tooltipWidth = tooltip.offsetWidth ? tooltip.offsetWidth : 165;\n        const tooltipEventPositionX = event.clientX;\n        let tooltipX = tooltipEventPositionX - tooltipWidth;\n        if (tooltipEventPositionX + (tooltipWidth * 2) > screenWidth) {\n            tooltipX = tooltipEventPositionX - (tooltipWidth * 2);\n        }\n\n        tooltipX = tooltipX.toString() + 'px';\n        tooltip.style.position = 'absolute';\n        tooltip.style.top = tooltipY;\n        tooltip.style.left = tooltipX;\n\n        // Show tooltip\n        this.timelineEventTooltip.classList.remove('spbc-timeline-hidden-element');\n        jQuery('[data-event-type]').filter(function() {\n            return jQuery(this).data('event-type') === eventName;\n        }).addClass('spbc-timelime-highlight-on-tooltip');\n    }\n\n    /**\n     * Hide event tooltip\n     */\n    hideEventTooltip() {\n        this.timelineEventTooltip.classList.add('spbc-timeline-hidden-element');\n        jQuery('[data-event-type]').removeClass('spbc-timelime-highlight-on-tooltip');\n    }\n\n    /**\n     * Draw timeline for specific user\n     * @param {string} user - Selected user name\n     */\n    drawUserTimeline(user) {\n        const svg = document.getElementById('spbc-timeline-svg');\n        const noDataMessage = document.getElementById('spbc-timeline-no-data');\n\n        // Clear previous content\n        svg.innerHTML = '';\n        noDataMessage.style.display = 'none';\n\n        let additionalEventsHeight = 0;\n        if (spbcTimelineWidgetData.found_types.length > 5) {\n            additionalEventsHeight = (spbcTimelineWidgetData.found_types.length - 5) * 12;\n        }\n\n        // Calculate dimensions\n        const width = svg.parentElement.clientWidth;\n        const height = 150 + additionalEventsHeight;\n\n        // Setup drawing area\n        const margin = {top: 10 + additionalEventsHeight, right: 40, bottom: 40, left: 140};\n        const contentWidth = width - margin.left - margin.right;\n        const contentHeight = height - margin.top - margin.bottom;\n        const baseLineY = contentHeight / 2;\n\n        svg.setAttribute('width', width);\n        svg.setAttribute('height', height);\n\n        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n        g.setAttribute('transform', `translate(${margin.left}, ${margin.top+30})`);\n        svg.appendChild(g);\n\n        // Calculate base positions\n\n\n        // Draw axis\n        this.drawTimeAxis(g, contentWidth, baseLineY + 10);\n\n        // Filter user events\n        const userEvents = (this.eventsData[user] || []).filter((event) =>\n            event.time >= this.timelineStartTimestamp &&\n            event.time <= this.currentTimestamp,\n        );\n\n        // Handle no events case\n        if (userEvents.length === 0) {\n            noDataMessage.style.display = 'block';\n            return;\n        }\n\n        const timeRange = this.currentTimestamp - this.timelineStartTimestamp;\n        const uniqueEventsCount = spbcTimelineWidgetData.found_types.length;\n\n        // Draw event lines and legends\n        for (let i = 0; i < uniqueEventsCount; i++) {\n            const userLineY = baseLineY - (SpbcTimelineWidget.userActionsUpstep * i);\n            const eventType = spbcTimelineWidgetData.found_types[i];\n            const color = this.timelineMarkersData[eventType].color;\n\n            // Draw event line\n            const userLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n            userLine.setAttribute('class', 'spbc-timeline-user-line');\n            userLine.setAttribute('x1', '0');\n            userLine.setAttribute('y1', userLineY);\n            userLine.setAttribute('x2', contentWidth);\n            userLine.setAttribute('y2', userLineY);\n            userLine.setAttribute('data-event-type', eventType);\n            g.appendChild(userLine);\n\n            // Draw legend circle\n            const legendCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n            legendCircle.setAttribute('class', 'spbc-timeline-legend-circle');\n            legendCircle.setAttribute('cx', SpbcTimelineWidget.legendCircleX);\n            legendCircle.setAttribute('cy', userLineY);\n            legendCircle.setAttribute('r', SpbcTimelineWidget.markerRadius);\n            legendCircle.style.fill = color;\n            g.appendChild(legendCircle);\n\n            // Draw legend text\n            const legendText = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n            legendText.setAttribute('class', 'spbc-timeline-legend-text');\n            legendText.setAttribute('x', SpbcTimelineWidget.legendTextX);\n            legendText.setAttribute('y', userLineY);\n            legendText.setAttribute('text-anchor', 'start');\n            legendText.setAttribute('dominant-baseline', 'middle');\n            legendText.setAttribute('data-event-type', eventType);\n            legendText.textContent = eventType;\n            g.appendChild(legendText);\n        }\n\n        // Draw events\n        userEvents.forEach((userEvent) => {\n            const x = ((userEvent.time - this.timelineStartTimestamp) / timeRange) * contentWidth;\n            const eventY = baseLineY + this.timelineMarkersData[userEvent.event].upstep;\n            g.appendChild(this.createEventElement(userEvent, x, eventY, user));\n        });\n    }\n\n    /**\n     * Generate marker data for events\n     * @param {Array} events - List of event types\n     * @return {Object} Marker configuration data\n     */\n    generateMarkersData(events) {\n        const colorMap = {};\n        let upstep = 0;\n        let colorScheme = 'default';\n\n        events.forEach((userEvent) => {\n            if (this.timelineKnownEventsData[userEvent] && this.timelineKnownEventsData[userEvent].color_scheme) {\n                colorScheme = this.timelineKnownEventsData[userEvent].color_scheme;\n            }\n            colorMap[userEvent] = {\n                color: colorScheme,\n                upstep: upstep,\n            };\n            upstep -= SpbcTimelineWidget.userActionsUpstep;\n        });\n\n        return colorMap;\n    }\n}\n\n/**\n * Wrapper\n */\nfunction spbcTimelineWidgetRender() { // eslint-disable-line no-unused-vars\n    const timelineWidget = new SpbcTimelineWidget();\n    jQuery( function() {\n        jQuery('#spbc-timeline-accordion').accordion({\n            collapsible: true,\n            active: false,\n        });\n    } );\n    timelineWidget.render();\n}\n\n"],"names":["SpbcTimelineWidget","markerRadius","hoursRangeMax","axisStepsCount","userActionsUpstep","legendCircleX","legendTextX","constructor","this","now","Date","currentTimestamp","Math","floor","getTime","eventsData","timelineMarkersData","timelineKnownEventsData","timelineEventTooltip","timelineStartTimestamp","usersCount","summaryEventsCount","render","activeTab","spbcTimelineWidgetData","document","getElementById","users_actions","Number","first_event_timestamp","known_events_data","generateMarkersData","found_types","querySelector","id","initTimeline","window","addEventListener","event","detail","tab","jQuery","on","e","hasOwnProperty","localStorage","getItem","setItem","userSelect","value","drawUserTimeline","key","users","Object","keys","length","innerHTML","forEach","appendChild","Option","user","style","display","activitySelector","innerText","replace","toString","isWidgetClosedByUser","setTimeout","trigger","drawTimeAxis","container","width","height","timeRange","axis","createElementNS","setAttribute","let","i","timestamp","x","tick","label","date","textContent","getHours","padStart","getMinutes","createEventElement","y","group","marker","JSON","stringify","fill","color","showEventTooltip","bind","hideEventTooltip","eventName","time","parse","currentTarget","getAttribute","month","getMonth","day","getDate","String","getFullYear","getSeconds","tooltip","tooltipY","offsetY","screenWidth","innerWidth","tooltipWidth","offsetWidth","tooltipEventPositionX","clientX","tooltipX","position","top","left","classList","remove","filter","data","addClass","add","removeClass","svg","noDataMessage","additionalEventsHeight","parentElement","clientWidth","margin","contentWidth","baseLineY","g","userEvents","uniqueEventsCount","userLineY","eventType","userLine","legendCircle","legendText","userEvent","eventY","upstep","events","colorMap","colorScheme","color_scheme","spbcTimelineWidgetRender","timelineWidget","accordion","collapsible","active"],"mappings":"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"}